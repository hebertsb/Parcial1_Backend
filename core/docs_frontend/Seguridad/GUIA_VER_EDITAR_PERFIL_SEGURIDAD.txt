# GU√çA SEGURIDAD - VER Y EDITAR PERFIL
================================================================

## üõ°Ô∏è PANEL SEGURIDAD - GESTI√ìN DE PERFIL PERSONAL

### üìã INFORMACI√ìN GENERAL
- **Rol**: Seguridad
- **Permisos**: Ver y editar su propio perfil + funciones de seguridad del edificio
- **Acceso**: Panel de seguridad con funciones espec√≠ficas de vigilancia

---

## üîç 1. VER PERFIL PERSONAL

### Endpoint para obtener datos propios:
```
GET /api/authz/usuarios/me/
```

### Headers requeridos:
```json
{
  "Authorization": "Bearer <token_seguridad>",
  "Content-Type": "application/json"
}
```

### Respuesta esperada:
```json
{
  "id": 20,
  "email": "seguridad@edificio.com",
  "estado": "ACTIVO",
  "is_staff": false,
  "is_superuser": false,
  "last_login": "2025-09-26T06:00:00Z",
  "date_joined": "2025-08-01T09:00:00Z",
  "persona": {
    "id": 20,
    "nombre": "Roberto Carlos",
    "apellido": "Vigilante",
    "documento_identidad": "55667788",
    "telefono": "73456789",
    "email": "seguridad@edificio.com",
    "fecha_nacimiento": "1985-11-25",
    "genero": "Masculino",
    "pais": "Bolivia",
    "direccion": "Zona Este #111",
    "tipo_persona": "seguridad",
    "activo": true
  },
  "roles": [
    {
      "id": 2,
      "nombre": "Seguridad",
      "descripcion": "Personal de seguridad del edificio",
      "activo": true
    }
  ],
  "nombres": "Roberto Carlos",
  "apellidos": "Vigilante",
  "telefono": "73456789",
  "fecha_nacimiento": "1985-11-25",
  "genero": "Masculino",
  "documento_identidad": "55667788",
  "pais": "Bolivia"
}
```

### üí° Informaci√≥n adicional espec√≠fica para seguridad:
- **Turno de trabajo**: Horario asignado
- **Zona de responsabilidad**: √Årea del edificio que vigila
- **Permisos especiales**: Acceso a c√°maras, registros, etc.

---

## ‚úèÔ∏è 2. EDITAR PERFIL PERSONAL (LIMITADO)

### Endpoint para editar datos propios:
```
PATCH /api/authz/usuarios/me/
```

### Headers requeridos:
```json
{
  "Authorization": "Bearer <token_seguridad>",
  "Content-Type": "application/json"
}
```

### Campos editables por personal de seguridad:
```json
{
  "telefono": "73987654",
  "direccion": "Nueva direcci√≥n zona Oeste #222",
  "email": "nuevo_seguridad@edificio.com"
}
```

### üö´ Campos restringidos para seguridad:
- `nombres`: Solo admin puede cambiar (contrato laboral)
- `apellidos`: Solo admin puede cambiar (contrato laboral)
- `roles`: Solo admin puede cambiar roles
- `estado`: Solo admin puede activar/desactivar
- `fecha_nacimiento`: Solo admin (documento legal)
- `documento_identidad`: Solo admin (verificaci√≥n laboral)
- `genero`: Solo admin
- `pais`: Solo admin

### Respuesta exitosa (200 OK):
```json
{
  "id": 20,
  "email": "nuevo_seguridad@edificio.com",
  "estado": "ACTIVO",
  "telefono": "73987654",
  "direccion": "Nueva direcci√≥n zona Oeste #222"
}
```

---

## üë• 3. VER INFORMACI√ìN DE RESIDENTES (SOLO LECTURA)

### Endpoint para consultar residentes:
```
GET /api/seguridad/residentes/
```

### Respuesta (informaci√≥n b√°sica para seguridad):
```json
[
  {
    "id": 5,
    "nombre_completo": "Mar√≠a Elena Propietaria",
    "vivienda": "A-101",
    "telefono": "71234567",
    "tipo_residente": "propietario",
    "estado": "activo",
    "foto_perfil": "/media/fotos/maria_elena.jpg"
  },
  {
    "id": 15,
    "nombre_completo": "Carlos Alberto Inquilino", 
    "vivienda": "A-101",
    "telefono": "72345678",
    "tipo_residente": "inquilino",
    "estado": "activo",
    "foto_perfil": "/media/fotos/carlos_alberto.jpg"
  }
]
```

### üí° Informaci√≥n √∫til para seguridad:
- **Identificaci√≥n visual**: Fotos de residentes
- **Ubicaci√≥n**: N√∫mero de vivienda
- **Contacto**: Tel√©fono para emergencias
- **Estado**: Activo/inactivo

---

## üö® 4. REGISTRAR INCIDENTES

### Endpoint para crear registro de incidente:
```
POST /api/seguridad/incidentes/
```

### Datos del incidente:
```json
{
  "tipo": "acceso_no_autorizado",
  "descripcion": "Persona desconocida intent√≥ ingresar al edificio",
  "fecha_hora": "2025-09-26T14:30:00Z",
  "ubicacion": "Puerta principal",
  "nivel_gravedad": "medio",
  "personas_involucradas": ["Desconocido"],
  "acciones_tomadas": "Se neg√≥ el acceso y se registr√≥ en video",
  "requiere_seguimiento": true
}
```

### Tipos de incidentes:
- `acceso_no_autorizado`
- `ruido_excesivo`
- `emergencia_medica`
- `problema_tecnico`
- `visitante_sospechoso`
- `otro`

---

## üìπ 5. ACCESO A SISTEMA DE VIGILANCIA

### Endpoint para acceder a c√°maras:
```
GET /api/seguridad/camaras/
```

### Respuesta:
```json
[
  {
    "id": 1,
    "nombre": "Entrada Principal",
    "ubicacion": "Lobby",
    "estado": "activa",
    "url_stream": "/api/seguridad/stream/1/",
    "grabacion_activa": true
  },
  {
    "id": 2,
    "nombre": "Parqueadero",
    "ubicacion": "S√≥tano",
    "estado": "activa", 
    "url_stream": "/api/seguridad/stream/2/",
    "grabacion_activa": true
  }
]
```

---

## üìã 6. REGISTROS DE VISITAS

### Endpoint para registrar visitas:
```
POST /api/seguridad/visitas/
```

### Datos de la visita:
```json
{
  "visitante_nombre": "Juan P√©rez Visitante",
  "visitante_documento": "98765432",
  "visitante_telefono": "74567890",
  "residente_visitado": 5,
  "vivienda_destino": "A-101",
  "hora_ingreso": "2025-09-26T15:00:00Z",
  "hora_salida": null,
  "motivo_visita": "Visita familiar",
  "autorizado_por": "propietario"
}
```

### Ver registro de visitas:
```
GET /api/seguridad/visitas/
```

---

## üîê 7. CAMBIAR CONTRASE√ëA

### Endpoint para cambio de contrase√±a:
```
POST /api/authz/change-password/
```

### Datos requeridos:
```json
{
  "password_actual": "contrase√±a_actual",
  "password_nueva": "nueva_contrase√±a_segura",
  "password_nueva_confirm": "nueva_contrase√±a_segura"
}
```

---

## üö® 8. EMERGENCIAS Y CONTACTOS

### Endpoint para emergencias:
```
POST /api/seguridad/emergencias/
```

### Datos de emergencia:
```json
{
  "tipo_emergencia": "medica",
  "ubicacion": "A-101",
  "descripcion": "Residente necesita atenci√≥n m√©dica",
  "nivel_urgencia": "alta",
  "servicios_contactados": ["ambulancia", "bomberos"],
  "estado": "en_proceso"
}
```

---

## üé® RECOMENDACIONES DE UI/UX PARA SEGURIDAD

### Dashboard de Seguridad:
1. **Estado del turno** (hora inicio/fin)
2. **C√°maras en vivo** (vista r√°pida)
3. **Incidentes del d√≠a** (lista reciente)
4. **Visitantes activos** (qui√©n est√° dentro)
5. **Botones de emergencia** (acceso r√°pido)

### Secci√≥n "Mi Perfil":
1. **Informaci√≥n personal** (campos limitados)
2. **Datos de contacto** (tel√©fono, email, direcci√≥n)
3. **Informaci√≥n del turno** (horarios, responsabilidades)
4. **Historial de incidentes** (reportados por √©l)

### Interfaz especializada:
- **Colores de alerta** (rojo, amarillo, verde)
- **Botones grandes** para emergencias
- **Vista nocturna** disponible
- **Acceso r√°pido** a funciones cr√≠ticas

---

## ‚ö†Ô∏è LIMITACIONES Y PERMISOS PARA SEGURIDAD

### üö´ Funciones NO disponibles:
- Editar informaci√≥n de residentes
- Acceder a datos financieros
- Cambiar roles de usuarios
- Ver informaci√≥n administrativa privada
- Modificar datos personales importantes

### ‚úÖ Funciones S√ç disponibles:
- Ver informaci√≥n b√°sica de residentes (para identificaci√≥n)
- Registrar incidentes y emergencias
- Acceder a sistema de c√°maras
- Registrar visitas
- Ver su propia informaci√≥n completa
- Contactar administraci√≥n/propietarios en emergencias

---

## üîí SEGURIDAD Y CONFIDENCIALIDAD

### Obligaciones del personal de seguridad:
- **Confidencialidad**: No divulgar informaci√≥n de residentes
- **Uso apropiado**: Solo usar datos para funciones de seguridad
- **Registro preciso**: Documentar todos los incidentes
- **Protocolo de emergencia**: Seguir procedimientos establecidos

---

## üîó ENDPOINTS ESPEC√çFICOS PARA SEGURIDAD

### Perfil personal:
- `GET /api/authz/usuarios/me/` - Ver perfil propio
- `PATCH /api/authz/usuarios/me/` - Editar perfil (limitado)
- `POST /api/authz/change-password/` - Cambiar contrase√±a

### Funciones de seguridad:
- `GET /api/seguridad/residentes/` - Ver lista de residentes
- `POST /api/seguridad/incidentes/` - Registrar incidentes
- `GET /api/seguridad/camaras/` - Acceder a c√°maras
- `POST /api/seguridad/visitas/` - Registrar visitas
- `GET /api/seguridad/visitas/` - Ver registro de visitas

### Emergencias:
- `POST /api/seguridad/emergencias/` - Reportar emergencias
- `GET /api/seguridad/contactos-emergencia/` - Contactos importantes

---

## üìû CONTACTOS IMPORTANTES PARA SEGURIDAD

### En el sistema:
- **Administrador**: admin@edificio.com
- **Emergencias m√©dicas**: 118
- **Bomberos**: 119  
- **Polic√≠a**: 110

### Contactos internos:
- **Administraci√≥n edificio**: Ver en sistema
- **Propietarios**: Ver en registro de residentes
- **Mantenimiento**: contacto@mantenimiento.com

---

## üïê GESTI√ìN DE TURNOS

### Funciones relacionadas con turnos:
- **Inicio de turno**: Registrar hora de entrada
- **Log de actividades**: Registro autom√°tico de acciones
- **Fin de turno**: Reporte de novedades del d√≠a
- **Cambio de turno**: Comunicaci√≥n con relevo

---

**Fecha de actualizaci√≥n**: 26 de septiembre de 2025
**Estado**: ‚úÖ FUNCIONAL - Permisos de seguridad configurados correctamente