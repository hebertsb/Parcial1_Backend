# GU√çA ADMINISTRADORES - VER Y EDITAR PERFIL
================================================================

## üîê PANEL ADMINISTRADOR - GESTI√ìN DE PERFIL PERSONAL

### üìã INFORMACI√ìN GENERAL
- **Rol**: Administrador
- **Permisos**: Ver y editar su propio perfil + gestionar otros usuarios
- **Acceso**: Panel de administraci√≥n completo

---

## üîç 1. VER PERFIL PERSONAL

### Endpoint para obtener datos propios:
```
GET /api/authz/usuarios/me/
```

### Headers requeridos:
```json
{
  "Authorization": "Bearer <token_admin>",
  "Content-Type": "application/json"
}
```

### Respuesta esperada:
```json
{
  "id": 1,
  "email": "admin@sistema.com",
  "estado": "ACTIVO",
  "is_staff": true,
  "is_superuser": false,
  "last_login": "2025-09-26T10:30:00Z",
  "date_joined": "2025-09-01T08:00:00Z",
  "persona": {
    "id": 1,
    "nombre": "Juan Carlos",
    "apellido": "Administrador",
    "documento_identidad": "12345678",
    "telefono": "70123456",
    "email": "admin@sistema.com",
    "fecha_nacimiento": "1985-05-15",
    "genero": "Masculino",
    "pais": "Bolivia",
    "direccion": "Av. Principal #123",
    "tipo_persona": "administrador",
    "activo": true
  },
  "roles": [
    {
      "id": 1,
      "nombre": "Administrador",
      "descripcion": "Administrador del sistema",
      "activo": true
    }
  ],
  "nombres": "Juan Carlos",
  "apellidos": "Administrador",
  "telefono": "70123456",
  "fecha_nacimiento": "1985-05-15",
  "genero": "Masculino",
  "documento_identidad": "12345678",
  "pais": "Bolivia"
}
```

### üí° Campos importantes para mostrar en el frontend:
- **Informaci√≥n b√°sica**: nombre, apellido, email
- **Datos personales**: tel√©fono, fecha de nacimiento, g√©nero
- **Datos del sistema**: fecha de registro, √∫ltimo login
- **Roles asignados**: siempre mostrar√° "Administrador"

---

## ‚úèÔ∏è 2. EDITAR PERFIL PERSONAL

### Endpoint para editar datos propios:
```
PATCH /api/authz/usuarios/me/
```

### Headers requeridos:
```json
{
  "Authorization": "Bearer <token_admin>",
  "Content-Type": "application/json"
}
```

### Campos editables:
```json
{
  "email": "nuevo_email@sistema.com",
  "nombres": "Juan Carlos Actualizado",
  "apellidos": "Administrador Nuevo",
  "telefono": "70987654",
  "fecha_nacimiento": "1985-05-15",
  "genero": "Masculino",
  "pais": "Bolivia",
  "direccion": "Nueva direcci√≥n #456"
}
```

### üö´ Campos NO editables por el propio admin:
- `roles`: Solo otros admins pueden cambiar roles
- `estado`: Solo otros admins pueden activar/desactivar
- `is_staff`, `is_superuser`: Solo superusuarios
- `date_joined`: Fecha de registro (solo lectura)

### Respuesta exitosa (200 OK):
```json
{
  "id": 1,
  "email": "nuevo_email@sistema.com",
  "estado": "ACTIVO",
  "nombres": "Juan Carlos Actualizado",
  "apellidos": "Administrador Nuevo",
  "telefono": "70987654",
  "roles": [
    {
      "id": 1,
      "nombre": "Administrador"
    }
  ]
}
```

---

## üîß 3. CAMBIAR CONTRASE√ëA

### Endpoint para cambio de contrase√±a:
```
POST /api/authz/change-password/
```

### Datos requeridos:
```json
{
  "password_actual": "contrase√±a_actual",
  "password_nueva": "nueva_contrase√±a_segura",
  "password_nueva_confirm": "nueva_contrase√±a_segura"
}
```

### Validaciones:
- Contrase√±a actual debe ser correcta
- Nueva contrase√±a m√≠nimo 8 caracteres
- Confirmaci√≥n debe coincidir

---

## üë• 4. FUNCIONALIDADES ADICIONALES PARA ADMIN

### Ver otros usuarios:
```
GET /api/authz/usuarios/
```

### Editar otros usuarios:
```
PATCH /api/authz/usuarios/{id}/
```

### Cambiar roles de usuarios:
```json
{
  "roles": [1, 2, 3]  // IDs de roles a asignar
}
```

---

## üé® RECOMENDACIONES DE UI/UX

### Secci√≥n "Mi Perfil":
1. **Vista de perfil** (modo solo lectura)
2. **Bot√≥n "Editar perfil"** ‚Üí formulario editable
3. **Bot√≥n "Cambiar contrase√±a"** ‚Üí modal separado
4. **Informaci√≥n del sistema** (fecha registro, √∫ltimo login)

### Formulario de edici√≥n:
- Campos organizados en secciones
- Validaci√≥n en tiempo real
- Botones "Guardar" y "Cancelar"
- Mensajes de confirmaci√≥n

### Seguridad:
- Timeout de sesi√≥n autom√°tico
- Confirmaci√≥n para cambios cr√≠ticos
- Auditor√≠a de cambios (opcional)

---

## ‚ö†Ô∏è CONSIDERACIONES IMPORTANTES

1. **Autorizaci√≥n**: Validar token en cada request
2. **Validaci√≥n**: Cliente y servidor deben validar datos
3. **Errores**: Manejar responses 400, 401, 403, 500
4. **UX**: Feedback visual para operaciones exitosas/fallidas
5. **Seguridad**: NUNCA mostrar contrase√±as en texto plano

---

## üîó ENDPOINTS RELACIONADOS

- `GET /api/authz/usuarios/me/` - Ver perfil propio
- `PATCH /api/authz/usuarios/me/` - Editar perfil propio  
- `POST /api/authz/change-password/` - Cambiar contrase√±a
- `GET /api/authz/usuarios/` - Listar todos los usuarios (admin)
- `PATCH /api/authz/usuarios/{id}/` - Editar cualquier usuario (admin)

---

**Fecha de actualizaci√≥n**: 26 de septiembre de 2025
**Estado**: ‚úÖ FUNCIONAL - Endpoints verificados y operativos